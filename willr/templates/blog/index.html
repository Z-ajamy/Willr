<!-- 
Blog index template.
Displays all blog posts in reverse chronological order with author information.
Authenticated users can create new posts, and authors can edit their own posts.
Extends the base template.
-->
{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}All Posts{% endblock %}</h1>
  
  <!-- Show create post button only for logged-in users -->
  {% if g.user %}
    <a class="action" href="{{ url_for('blog.create') }}">Create New Post</a>
  {% endif %}
{% endblock %}

{% block content %}
  <!-- Loop through all posts and display them -->
  {% for post in posts %}
    <article class="post">
      <header>
        <div>
          <h1>{{ post['title'] }}</h1>
          <div class="about">by {{ post['username'] }} on {{ post['created'].strftime('%Y-%m-%d') }}</div>
        </div>
        
        <!-- Show edit button only to the post author -->
        {% if g.user['id'] == post['author_id'] %}
          <a class="action" href="{{ url_for('blog.update', id=post['id']) }}">Edit</a>
        {% endif %}
      </header>
      <p class="body">{{ post['body'] }}</p>
    </article>
    
    <!-- Add separator between posts, except after the last one -->
    {% if not loop.last %}
      <hr>
    {% endif %}
  {% endfor %}
{% endblock %}
